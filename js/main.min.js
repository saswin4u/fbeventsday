var App,AppDirect,preDefinedEvents=[{name:"eBuildInObject1",hook:"returnBtnEvent"},{name:"eBuildInObject2",hook:"returnBtnEvent"},{name:"eBuildInObject3",hook:"returnBtnEvent"}];(function(e,t,n){"use strict";var r={eBuildInObject1:[{id:1,start:60,end:120},{id:2,start:100,end:240},{id:3,start:180,end:400},{id:4,start:320,end:460},{id:5,start:600,end:700},{id:6,start:90,end:150},{id:7,start:110,end:180},{id:8,start:200,end:350},{id:9,start:130,end:170},{id:10,start:120,end:180},{id:11,start:200,end:180},{id:12,start:330,end:420},{id:13,start:210,end:270},{id:14,start:240,end:270},{id:15,start:270,end:300},{id:16,start:300,end:330},{id:17,start:480,end:600}],eBuildInObject2:[{id:1,start:60,end:120},{id:2,start:100,end:240},{id:3,start:700,end:720}],eBuildInObject3:[{id:1,start:60,end:120},{id:2,start:90,end:180},{id:3,start:120,end:330},{id:4,start:150,end:240},{id:5,start:210,end:300},{id:6,start:270,end:360}]},i=e("#inner-wrap"),s=i.width(),o=i.height(),u=function(){function r(){return{createElement:function(n,r){var i=t.createDocumentFragment(),s,o=1e4,u=r.find(".span12");this.loadData(n);e.each(n,function(t,n){s=e("<div />").css({top:n.top,width:n.width,height:n.height,left:n.left,position:"absolute",zIndex:o+t}).addClass("event-block").html("<h1>Sample Item "+n.id+"</h1><p>Sample Location</p>");i.appendChild(s[0])});u.empty();u[0].appendChild(i)},convertDataToJSON:function(e){var t=4;if(typeof e==="undefined"){return}if(typeof e==="object"){return JSON.stringify(e,null,t)}},loadData:function(t){var n=this,r=e("#renderResults").find("textarea");r.val(n.convertDataToJSON(t))},appendBtnEvent:function(){var t=this,n=e("#showRenderBtn"),r=e("#renderResults"),i=e("#enterObjectValueInputField"),s=i.width(),o=e(".append"),u='.btn[data-toggle="dropdown"]',a=e(u),f=a.find("span.text"),l='.btn[data-toggle="render"]',c=e(l),h="selectionBtnToolbar",p;n.on("click",function(t){t.preventDefault();p.showRenderBtnHandler(e(this))});o.on("click",u,function(t){t.preventDefault();p.showToggleMenuHandler(e(this))});o.on("click",".dropdown-menu a",function(t){t.preventDefault();p.actionSelectionHandler(e(this))});o.on("click",l,function(e){e.preventDefault();App.loadPlainJSText(i)});p={showRenderBtnHandler:function(e){var t=r.attr("class"),n=t.indexOf("shown");e.find("span").html(n>0?"Show":"Hide");r.toggleClass("hidden").toggleClass("shown");this.scrollUI(r)},scrollUI:function(t){e("html:not(:animated),body:not(:animated)").animate({scrollTop:t.offset().top},500)},showToggleMenuHandler:function(e){e.closest(".btn-group").toggleClass("open")},actionSelectionHandler:function(t){var n=t.text().toLowerCase().substring(0,5);switch(n){case"plain":case"serve":i.attr("disabled",false).attr("placeholder",n==="plain"?'Enter the object eg., {"id" : 1, "start" : 60, "end" : 120}':"Enter URL").show();e("#"+h).hide();break;case"in-bu":var r=e('<div class="btn-toolbar" id="'+h+'"></div>'),o=e('<div class="btn-group"></div>').appendTo(r),u=e("#"+h).length,l=s/preDefinedEvents.length-20,p;if(u<=0){e.each(preDefinedEvents,function(t,n){p=e('<a class="btn invoke-builtin">').attr({href:n.name}).css({width:l+"px"}).data("eventhook",n.hook).html("Event "+(t+1));o.append(p)});r.append(o).insertAfter(i.hide())}else{e("#"+h).show();i.hide()}this.appendActionToEventEl();break}c.prop("disabled",n==="in-bu"?true:false).data("trigger",n);a.trigger("click");f.text(n+"...")},appendActionToEventEl:function(){o.unbind("click.inbuild").on("click.inbuild",".invoke-builtin",function(t){t.preventDefault();var n=e(this);App[n.data("eventhook")](n.attr("href"))})}}}}}var n;return{load:function(){if(!n){n=r()}return n}}}(),a=function(){function r(){return{createDivs:function(){var n=t.createDocumentFragment(),r,i=30,s=60,o=0,u=720,a=9,f=0,l,c,h=e("#timing");for(o;o<=u;o=o+i){l=o%s;if(l===0){c=(a>12?(a-12).toString():a.toString())+":00"+'<span class="time-small">'+(a>=12?" pm":" am")+"</span>";++f}else{c='<span class="time-small">'+(a>12?(a-12).toString():a.toString())+":30"+(a>=12?" pm":" am")+"</span>";f=0;++a}r=e("<div />").css({height:"29.5px","text-align":"right"}).html(c);n.appendChild(r[0])}h.empty();h[0].appendChild(n)}}}var n;return{load:function(){if(!n){n=r();n.createDivs()}return n}}}(),f=function(){function n(){return{getThingsDone:function(t){var n=this;n.columns=[];n.lastEventEnding=null;n.baseEvents=t;n.maxEndTime=s;e.proxy(n.getInitialObjectBuild(n.baseEvents),n);e.proxy(n.sortEventsBystartAndend(n.modifiedEvent),n);e.proxy(n.loopThroughEvent(n.modifiedEvent),n);return n.modifiedEvent},getInitialObjectBuild:function(t){this.modifiedEvent=e.map(t,function(e,t){if(e.start<e.end&&e.end<=o){return{id:e.id,top:e.start,height:e.end-e.start-2,bottom:e.end}}else{return null}})},sortEventsBystartAndend:function(e){this.modifiedEvent=e.sort(function(e,t){if(e.top<t.top){return-1}if(e.top>t.top){return 1}if(e.bottom<t.bottom){return-1}if(e.bottom>t.bottom){return 1}return 0})},loopThroughEvent:function(t){var n=this,r;e(t).each(function(e,t){if(n.lastEventEnding!==null&&t.top>=n.lastEventEnding){n.arrangeEventColumns(n.columns,s);n.columns=[];n.lastEventEnding=null}var i=false,o=0,u=n.columns.length;for(o;o<u;o++){r=n.columns[o];if(!n.findCollidingEvent(r[r.length-1],t)){r.push(t);i=true;break}}if(!i){n.columns.push([t])}if(n.lastEventEnding===null||t.bottom>n.lastEventEnding){n.lastEventEnding=t.bottom}if(n.columns.length>0){n.arrangeEventColumns(n.columns,s)}})},arrangeEventColumns:function(e,t){var n=e.length,r,i,s,o,u,a;for(r=0;r<n;r++){o=e[r];u=o.length;a=t/n;for(i=0;i<u;i++){s=o[i];s.left=r/n*t;s.width=a-5}}},findCollidingEvent:function(e,t){return e.bottom>=t.top&&e.top<=t.bottom}}}var t;return{load:function(){if(!t){t=n()}return t}}}(),l=function(){function c(){o.appendBtnEvent();return{loadPlainJSText:function(t){var n=t.val(),r=this,i;if(n&&n!==""){try{r.objectText=e.parseJSON(n);r.returnBtnEvent(i)}catch(s){alert("Unacceptable Input Type"+s)}}else{alert("Text box cannot be empty")}},loadServerUrl:function(){},returnBtnEvent:function(e){var t;if(e){t=r[e]}else{t=this.objectText}l=n.getThingsDone(t);o.createElement(l,i)}}}var t,n=f.load(),s=a.load(),o=u.load(),l;return{load:function(){if(!t){t=c()}return t}}}();App=l.load();AppDirect=f.load()})(jQuery,window.document)